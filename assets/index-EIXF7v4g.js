import{f as b,j as e,b as w,K as W,N as $,O as A,P as K,Q as F,R as E,U as G,V as g,W as i,X as N,Y as m,L as u,I as R,C as U,D as V,p as X,q,r as _,n as Q,H as y,B as z,T as S,F as J}from"./index-DPl9zu-i.js";import{L as Z}from"./LineChart-VWWycjCL.js";import{a as ee}from"./fetch-DAvlDv-e.js";var M=b(function(s,t){const{templateAreas:a,gap:o,rowGap:d,columnGap:l,column:n,row:p,autoFlow:c,autoRows:x,templateRows:h,autoColumns:T,templateColumns:j,...f}=s,k={display:"grid",gridTemplateAreas:a,gridGap:o,gridRowGap:d,gridColumnGap:l,gridAutoColumns:T,gridColumn:n,gridRow:p,gridAutoFlow:c,gridAutoRows:x,gridTemplateRows:h,gridTemplateColumns:j};return e.jsx(w.div,{ref:t,__css:k,...f})});M.displayName="Grid";function I(r){return $(r,s=>s==="auto"?"auto":`span ${s}/span ${s}`)}var C=b(function(s,t){const{area:a,colSpan:o,colStart:d,colEnd:l,rowEnd:n,rowSpan:p,rowStart:c,...x}=s,h=W({gridArea:a,gridColumn:I(o),gridRow:I(p),gridColumnStart:d,gridColumnEnd:l,gridRowStart:c,gridRowEnd:n});return e.jsx(w.div,{ref:t,__css:h,...x})});C.displayName="GridItem";var Y=b((r,s)=>{const{placement:t="bottom",...a}=r,o=A();return e.jsx(w.caption,{...a,ref:s,__css:{...o.caption,captionSide:t}})});Y.displayName="TableCaption";var se=b((r,s)=>{const t=A();return e.jsx(w.tfoot,{...r,ref:s,__css:t.tfoot})}),re=K({displayName:"ExternalLinkIcon",path:e.jsxs("g",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeWidth:"2",children:[e.jsx("path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"}),e.jsx("path",{d:"M15 3h6v6"}),e.jsx("path",{d:"M10 14L21 3"})]})});const P=({itemType:r,items:s})=>e.jsx(e.Fragment,{children:e.jsx(F,{whiteSpace:"wrap",height:"100vh",overflowY:"auto",children:e.jsxs(E,{variant:"striped",colorScheme:"alternatePurple",children:[e.jsxs(Y,{placement:"top",children:["Top ",r]}),e.jsx(G,{children:e.jsxs(g,{children:[e.jsx(i,{fontSize:{sm:"12px",base:"16px",md:"18px"},children:"#"}),e.jsx(i,{fontSize:{sm:"12px",base:"16px",md:"18px"},children:r}),e.jsx(i,{fontSize:{sm:"12px",base:"16px",md:"18px"},children:"Album"})]})}),e.jsx(N,{children:s==null?void 0:s.map((t,a)=>e.jsxs(g,{h:"auto",w:"100%",children:[e.jsx(m,{fontSize:{sm:"12px",base:"16px",md:"18px"},children:a+1}),e.jsx(m,{fontSize:{sm:"12px",base:"16px",md:"18px"},children:e.jsx(u,{href:t.external_urls.spotify,target:"_blank",children:t.name})}),e.jsx(m,{children:e.jsx(R,{src:r==="Artists"?t.images[0].url:t.album.images[0].url,objectFit:"contain",boxSize:{sm:"26px",base:"36px",md:"48px"},minWidth:"26px",fallbackSrc:"https://via.placeholder.com/150"})})]},`recently played ${t.name,a}`))}),e.jsx(se,{children:e.jsxs(g,{children:[e.jsx(i,{fontSize:{sm:"12px",base:"16px",md:"18px"},children:"#"}),e.jsx(i,{fontSize:{sm:"12px",base:"16px",md:"18px"},children:r}),e.jsx(i,{fontSize:{sm:"12px",base:"16px",md:"18px"},children:"Image"})]})})]})})}),te=({recentlyPlayedSongs:r})=>e.jsx(e.Fragment,{children:e.jsx(F,{whiteSpace:"wrap",height:"100vh",overflowY:"auto",children:e.jsxs(E,{variant:"striped",colorScheme:"alternatePurple",children:[e.jsx(G,{children:e.jsxs(g,{children:[e.jsx(i,{fontSize:{base:"16",md:"18"},children:"Time"}),e.jsx(i,{fontSize:{base:"16",md:"18"},children:"Track"}),e.jsx(i,{fontSize:{base:"16",md:"18"},children:"Artist"}),e.jsx(i,{fontSize:{base:"16",md:"18"},children:"Album"})]})}),e.jsx(N,{children:r==null?void 0:r.map((s,t)=>{var o,d,l,n,p,c,x;const a=new Date(s.played_at).toLocaleString();return e.jsxs(g,{height:"auto",w:"100%",children:[e.jsx(m,{fontSize:{sm:"12px",base:"16px",md:"18px"},children:a}),e.jsx(m,{fontSize:{sm:"12px",base:"16px",md:"18px"},children:e.jsx(u,{href:(o=s.external_urls)==null?void 0:o.spotify,target:"_blank",children:s.name})}),e.jsx(m,{fontSize:{sm:"12px",base:"16px",md:"18px"},children:e.jsx(u,{href:(l=(d=s.artists[0])==null?void 0:d.external_urls)==null?void 0:l.spotify,target:"_blank",children:(n=s.artists[0])==null?void 0:n.name})}),e.jsx(m,{children:e.jsx(u,{href:(p=s.album.external_urls)==null?void 0:p.spotify,target:"_blank",children:e.jsx(R,{src:(x=(c=s.album)==null?void 0:c.images[0])==null?void 0:x.url,objectFit:"contain",boxSize:{sm:"26px",base:"36px",md:"48px"},minWidth:"26px",fallbackSrc:"https://via.placeholder.com/150"})})})]},`recently played ${s.name,t}`)})})]})})}),ae="/music-tracker/assets/Spotify_Logo_CMYK_Green-DyYrXFhI.png",ie=()=>{var v,L;const r=U(),{user:s,userMutate:t,loggedOut:a}=V(),{data:o,isLoading:d,error:l}=X(),{data:n,isLoading:p}=q(),[c,x]=_.useState(!0),[h,T]=_.useState(!0),{session:j}=Q(),{data:f,error:k}=ee(j==null?void 0:j.user.id);console.log(k,l,d,p),_.useEffect(()=>{a&&t(null,!1).then(()=>r("/"))},[a,t]);const H=()=>{x(!c)},B=()=>{T(!h)};if(!s)return e.jsx(y,{children:"Please connect your Spotify to see your profile"});if(l)return console.error(l),console.log(l.status),console.log(l.body),e.jsx(y,{children:"Error"});const D=o?o.map(O=>O.popularity):[];return e.jsx(e.Fragment,{children:e.jsxs(z,{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",marginBlock:"5%",children:[e.jsxs(z,{alignItems:"flex-start",width:"100%",padding:3,children:[e.jsx(S,{fontSize:"3xl",children:f==null?void 0:f.username}),e.jsx(u,{href:s.external_urls.spotify,target:"_blank",isExternal:!0,_hover:{fontStyle:"normal"},children:e.jsxs(J,{alignItems:"center",children:[e.jsxs(S,{fontSize:["md","lg"],children:[s.display_name," on"]}),e.jsx(R,{src:ae,width:["80px"],height:["24px"],mx:"2px",fallbackSrc:"https://via.placeholder.com/150"}),e.jsx(re,{})]})}),e.jsxs(S,{children:[s.product==="premium"?"Premium":"Free"," user"]}),e.jsxs(S,{children:["Followers: ",s.followers.total]})]}),e.jsx(Z,{title:"Popularity",description:"Popularity of your 50 most recently played tracks. Based on number of listens and how recent they were.",data:D}),e.jsxs(u,{onClick:B,children:[h?"Hide":"Show"," Recently Played"]}),h?e.jsxs(e.Fragment,{children:[e.jsx(y,{children:"Recently Played Tracks"}),e.jsx(te,{recentlyPlayedSongs:o})]}):null,e.jsxs(u,{onClick:H,children:[c?"Hide":"Show"," Top Items"]}),e.jsx(y,{children:"Top Artists And Tracks"}),e.jsxs(M,{templateColumns:"repeat(2, 1fr)",gap:6,p:6,w:"100%",children:[e.jsx(C,{w:"100%",noOfLines:1,children:e.jsx(P,{itemType:"Artists",items:(v=n==null?void 0:n.artists)==null?void 0:v.items})}),e.jsx(C,{w:"100%",noOfLines:1,children:e.jsx(P,{itemType:"Tracks",items:(L=n==null?void 0:n.tracks)==null?void 0:L.items})})]})]})})};export{ie as ProfileRoute};
